(myenv) fusionshen@fusionshen-ThinkPad-T14-Gen-1:~/Desktop/LLM/ask_agent$ uvicorn main:app --host 0.0.0.0 --port 9000
âœ… Using ChatOllama from langchain-ollama
/home/fusionshen/myenv/lib/python3.12/site-packages/jieba/_compat.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
INFO:     Started server process [2765693]
INFO:     Waiting for application startup.
2025-10-21 09:39:55,003 | INFO | ðŸ”„ æ­£åœ¨åˆå§‹åŒ–å…¬å¼æ•°æ®ï¼ˆfull loadï¼‰...
Building prefix dict from the default dictionary ...
2025-10-21 09:39:58,854 | DEBUG | Building prefix dict from the default dictionary ...
Loading model from cache /tmp/jieba.cache
2025-10-21 09:39:58,854 | DEBUG | Loading model from cache /tmp/jieba.cache
Loading model cost 0.644 seconds.
2025-10-21 09:39:59,498 | DEBUG | Loading model cost 0.644 seconds.
Prefix dict has been built successfully.
2025-10-21 09:39:59,498 | DEBUG | Prefix dict has been built successfully.
 2025-10-21 09:40:13,055 | INFO | âœ… Loaded 270817 formulas. Tokenization ready.
2025-10-21 09:40:13,061 | INFO | Auto-selected embedding device: cpu
2025-10-21 09:40:13,061 | INFO | ðŸ§© å°è¯•åŠ è½½æœ¬åœ°æ¨¡åž‹: /home/fusionshen/Desktop/LLM/ask_agent/models/sbert_offline_models/86741b4e3f5cb7765a600d3a3d55a0f6a6cb443d
2025-10-21 09:40:13,062 | INFO | Load pretrained SentenceTransformer: /home/fusionshen/Desktop/LLM/ask_agent/models/sbert_offline_models/86741b4e3f5cb7765a600d3a3d55a0f6a6cb443d
2025-10-21 09:40:13,970 | INFO | âœ… å·²æˆåŠŸåŠ è½½ç¦»çº¿æ¨¡åž‹ã€‚
2025-10-21 09:40:14,670 | INFO | âœ… Loaded embeddings from cache ((270817, 384))
2025-10-21 09:40:14,670 | INFO | âœ… åˆå§‹åŒ–å®Œæˆï¼Œç”¨æ—¶ 19.67s
2025-10-21 09:40:14,670 | INFO | âœ… formula_api åˆå§‹åŒ–å®Œæˆï¼Œç”¨æ—¶ 19.67s
2025-10-21 09:40:14,670 | INFO | ðŸ§¹ å·²å¯åŠ¨ session å®šæœŸæ¸…ç†ä»»åŠ¡ã€‚
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:9000 (Press CTRL+C to quit)
INFO:     127.0.0.1:37970 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:36594 - "GET /openapi.json HTTP/1.1" 200 OK
2025-10-21 09:44:43,742 | INFO | ðŸŸ¢ [handle_chat] å¼€å§‹å¤„ç† user=shenlan, input='å¸®æˆ‘æŸ¥çœ‹2022å¹´10æœˆ2æ—¥çš„é«˜ç‚‰å·¥åºèƒ½è€—'
2025-10-21 09:44:43,742 | INFO | âœ… å½“å‰ slots: {'indicator': None, 'formula': None, 'formula_candidates': None, 'awaiting_confirmation': False, 'timeString': None, 'timeType': None}
2025-10-21 09:44:43,742 | INFO | ðŸ”¹ å¡«å…… indicator: å¸®æˆ‘æŸ¥çœ‹2022å¹´10æœˆ2æ—¥çš„é«˜ç‚‰å·¥åºèƒ½è€—
Batches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 15.91it/s]
2025-10-21 09:44:45,304 | INFO | âœ… formula_api.formula_query_dict ç”¨æ—¶ 1.56s, keys=['done', 'candidates']
INFO:     127.0.0.1:55356 - "GET /chat?user_id=shenlan&message=%E5%B8%AE%E6%88%91%E6%9F%A5%E7%9C%8B2022%E5%B9%B410%E6%9C%882%E6%97%A5%E7%9A%84%E9%AB%98%E7%82%89%E5%B7%A5%E5%BA%8F%E8%83%BD%E8%80%97 HTTP/1.1" 200 OK
2025-10-21 09:45:12,147 | INFO | ðŸŸ¢ [handle_chat] å¼€å§‹å¤„ç† user=shenlan, input='4'
2025-10-21 09:45:12,147 | INFO | âœ… å½“å‰ slots: {'indicator': 'å¸®æˆ‘æŸ¥çœ‹2022å¹´10æœˆ2æ—¥çš„é«˜ç‚‰å·¥åºèƒ½è€—', 'formula': None, 'formula_candidates': [{'number': 1, 'FORMULAID': 'GXNHLT1102.IXRL', 'FORMULANAME': '2é«˜ç‚‰å·¥åºèƒ½è€—å®žç»©æŠ¥å‡ºå€¼', 'score': 67.0589, 'fuzzy_score': 77.9143, 'semantic_score': 50.5185, 'match_kind': 'hybrid'}, {'number': 2, 'FORMULAID': 'GXNHLT1102.IXPL.SUMVALUE', 'FORMULANAME': '2é«˜ç‚‰å·¥åºèƒ½è€—è®¡åˆ’ç´¯è®¡å€¼', 'score': 66.7, 'fuzzy_score': 69.3, 'semantic_score': 68.3813, 'match_kind': 'hybrid'}, {'number': 3, 'FORMULAID': 'GXNHLT1100.IXRL.SUMVALUE', 'FORMULANAME': 'é«˜ç‚‰å·¥åºèƒ½è€—å®žç»©ç´¯è®¡å€¼', 'score': 66.046, 'fuzzy_score': 70.56, 'semantic_score': 56.9628, 'match_kind': 'hybrid'}, {'number': 4, 'FORMULAID': 'GXNHLT1100.IXRL', 'FORMULANAME': 'é«˜ç‚‰å·¥åºèƒ½è€—å®žç»©æŠ¥å‡ºå€¼', 'score': 66.0187, 'fuzzy_score': 72.72, 'semantic_score': 52.3919, 'match_kind': 'hybrid'}, {'number': 5, 'FORMULAID': 'GXNHLT1102.IXPL', 'FORMULANAME': '2é«˜ç‚‰å·¥åºèƒ½è€—è®¡åˆ’æŠ¥å‡ºå€¼', 'score': 65.9957, 'fuzzy_score': 71.4214, 'semantic_score': 62.3896, 'match_kind': 'hybrid'}], 'awaiting_confirmation': False, 'timeString': None, 'timeType': None}
2025-10-21 09:45:12,147 | INFO | âœ… ç”¨æˆ·é€‰æ‹©å…¬å¼ç¼–å· 4: é«˜ç‚‰å·¥åºèƒ½è€—å®žç»©æŠ¥å‡ºå€¼
2025-10-21 09:45:12,673 | INFO | HTTP Request: GET http://192.168.92.13:11434/api/tags "HTTP/1.1 200 OK"
2025-10-21 09:45:51,442 | INFO | HTTP Request: POST http://192.168.92.13:11434/api/chat "HTTP/1.1 200 OK"
INFO:     127.0.0.1:45270 - "GET /chat?user_id=shenlan&message=4 HTTP/1.1" 200 OK
2025-10-21 09:46:34,307 | INFO | ðŸŸ¢ [handle_chat] å¼€å§‹å¤„ç† user=shenlan, input='2022å¹´10æœˆ2æ—¥'
2025-10-21 09:46:34,308 | INFO | âœ… å½“å‰ slots: {'indicator': 'é«˜ç‚‰å·¥åºèƒ½è€—å®žç»©æŠ¥å‡ºå€¼', 'formula': 'GXNHLT1100.IXRL', 'formula_candidates': None, 'awaiting_confirmation': False, 'timeString': None, 'timeType': None}
2025-10-21 09:46:34,377 | INFO | HTTP Request: GET http://192.168.92.13:11434/api/tags "HTTP/1.1 200 OK"
2025-10-21 09:46:35,127 | INFO | HTTP Request: POST http://192.168.92.13:11434/api/chat "HTTP/1.1 200 OK"
ðŸŸ¢ ç™»å½•è¿”å›žï¼š {'error': None, 'data': {'token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOiIxNDMiLCJ0ZW5hbnRpZCI6IjEwNSIsInVuYW1lIjoi566h55CG5ZGYIiwidG5hbWUiOiLlrp3pkqLmuZvmsZ_pkqLpk4HmnInpmZDlhazlj7giLCJ0c2lkZSI6IjEiLCJncm91cGlkIjoiMCIsInNsaWRpbmciOiIwIiwicnNpbmNlIjoiMTc2MTE1NDg5NiIsIm5iZiI6MTc2MTAxMDU5NiwiZXhwIjoxNzYxMTI2Mzk2LCJpc3MiOiJzaGJhb25lbmciLCJhdWQiOiJzaGJhb25lbmcifQ.D88Z3Cosp6ZwmPjscCZxchAl0v8-WEXWdawheD6byQw', 'expiresAt': '2025-10-22 17:45:36', 'tenantId': 105, 'tenancyName': 'zjis', 'userId': 143, 'userName': 'admin'}, 'status': 200, 'msg': 'æ“ä½œæˆåŠŸ', 'duration': -1}
{'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOiIxNDMiLCJ0ZW5hbnRpZCI6IjEwNSIsInVuYW1lIjoi566h55CG5ZGYIiwidG5hbWUiOiLlrp3pkqLmuZvmsZ_pkqLpk4HmnInpmZDlhazlj7giLCJ0c2lkZSI6IjEiLCJncm91cGlkIjoiMCIsInNsaWRpbmciOiIwIiwicnNpbmNlIjoiMTc2MTE1NDg5NiIsIm5iZiI6MTc2MTAxMDU5NiwiZXhwIjoxNzYxMTI2Mzk2LCJpc3MiOiJzaGJhb25lbmciLCJhdWQiOiJzaGJhb25lbmcifQ.D88Z3Cosp6ZwmPjscCZxchAl0v8-WEXWdawheD6byQw', 'Content-Type': 'application/json'}
{'expressionList': {'GXNHLT1100.IXRL': 'GXNHLT1100.IXRL'}, 'clock': '2022-10-02', 'timegranId': 'DAY'}
{'error': None, 'data': {'GXNHLT1100.IXRL': '374.41'}, 'status': 200, 'msg': 'æ“ä½œæˆåŠŸ', 'duration': -1}
2025-10-21 09:46:37,116 | INFO | âœ… platform_api.query_platform ç”¨æ—¶ 0.58s, result={'GXNHLT1100.IXRL': '374.41'}
2025-10-21 09:46:37,116 | INFO | âœ… handle_chat å…¨æµç¨‹å®Œæˆï¼Œç”¨æ—¶ 2.81s
INFO:     127.0.0.1:56244 - "GET /chat?user_id=shenlan&message=2022%E5%B9%B410%E6%9C%882%E6%97%A5 HTTP/1.1" 200 OK


ðŸŸ¢ ç™»å½•è¿”å›žï¼š {'error': None, 'data': {'token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOiIxMDU0IiwidGVuYW50aWQiOiIxMDUiLCJ1bmFtZSI6IuW8gOaUvuaOiOadg--8muiDvea6kOeuoeeQhiIsInRuYW1lIjoi5a6d6ZKi5rmb5rGf6ZKi6ZOB5pyJ6ZmQ5YWs5Y-4IiwidHNpZGUiOiIxIiwiZ3JvdXBpZCI6IjAiLCJzbGlkaW5nIjoiMCIsInJzaW5jZSI6IjE3NjEwOTkxODQiLCJuYmYiOjE3NjA5NTQ4ODQsImV4cCI6MTc2MTA3MDY4NCwiaXNzIjoic2hiYW9uZW5nIiwiYXVkIjoic2hiYW9uZW5nIn0.HuQp7cPscuyHyVW-6uO71YDkG6-FeRvw-0u6bMtCN-I', 'expiresAt': '2025-10-22 02:17:04', 'tenantId': 105, 'tenancyName': 'zjis', 'userId': 1054, 'userName': 'ecshare'}, 'status': 200, 'msg': 'æ“ä½œæˆåŠŸ', 'duration': -1}
{'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOiIxMDU0IiwidGVuYW50aWQiOiIxMDUiLCJ1bmFtZSI6IuW8gOaUvuaOiOadg--8muiDvea6kOeuoeeQhiIsInRuYW1lIjoi5a6d6ZKi5rmb5rGf6ZKi6ZOB5pyJ6ZmQ5YWs5Y-4IiwidHNpZGUiOiIxIiwiZ3JvdXBpZCI6IjAiLCJzbGlkaW5nIjoiMCIsInJzaW5jZSI6IjE3NjEwOTkxODQiLCJuYmYiOjE3NjA5NTQ4ODQsImV4cCI6MTc2MTA3MDY4NCwiaXNzIjoic2hiYW9uZW5nIiwiYXVkIjoic2hiYW9uZW5nIn0.HuQp7cPscuyHyVW-6uO71YDkG6-FeRvw-0u6bMtCN-I', 'Content-Type': 'application/json'}
{'expressionList': {'GXNHLT1100.IXRL': 'GXNHLT1100.IXRL'}, 'clock': '2022-10-02', 'timegranId': 'DAY'}
{'error': None, 'data': None, 'status': 500, 'msg': 'è°ƒç”¨å¤±è´¥', 'duration': 0}
æŸ¥è¯¢ç»“æžœï¼š None

ðŸŸ¢ ç™»å½•è¿”å›žï¼š {'error': None, 'data': {'token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOiIxNDMiLCJ0ZW5hbnRpZCI6IjEwNSIsInVuYW1lIjoi566h55CG5ZGYIiwidG5hbWUiOiLlrp3pkqLmuZvmsZ_pkqLpk4HmnInpmZDlhazlj7giLCJ0c2lkZSI6IjEiLCJncm91cGlkIjoiMCIsInNsaWRpbmciOiIwIiwicnNpbmNlIjoiMTc2MTA5OTk1MCIsIm5iZiI6MTc2MDk1NTY1MCwiZXhwIjoxNzYxMDcxNDUwLCJpc3MiOiJzaGJhb25lbmciLCJhdWQiOiJzaGJhb25lbmcifQ.6BCSZMkwutpR-QYTzvkxz8gXGlLcS28Eyj2m21gq1-Q', 'expiresAt': '2025-10-22 02:29:50', 'tenantId': 105, 'tenancyName': 'zjis', 'userId': 143, 'userName': 'admin'}, 'status': 200, 'msg': 'æ“ä½œæˆåŠŸ', 'duration': -1}
{'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOiIxNDMiLCJ0ZW5hbnRpZCI6IjEwNSIsInVuYW1lIjoi566h55CG5ZGYIiwidG5hbWUiOiLlrp3pkqLmuZvmsZ_pkqLpk4HmnInpmZDlhazlj7giLCJ0c2lkZSI6IjEiLCJncm91cGlkIjoiMCIsInNsaWRpbmciOiIwIiwicnNpbmNlIjoiMTc2MTA5OTk1MCIsIm5iZiI6MTc2MDk1NTY1MCwiZXhwIjoxNzYxMDcxNDUwLCJpc3MiOiJzaGJhb25lbmciLCJhdWQiOiJzaGJhb25lbmcifQ.6BCSZMkwutpR-QYTzvkxz8gXGlLcS28Eyj2m21gq1-Q', 'Content-Type': 'application/json'}
{'expressionList': {'GXNHLT1100.IXRL': 'GXNHLT1100.IXRL'}, 'clock': '2022-10-02', 'timegranId': 'DAY'}
{'error': None, 'data': {'GXNHLT1100.IXRL': '374.41'}, 'status': 200, 'msg': 'æ“ä½œæˆåŠŸ', 'duration': -1}
æŸ¥è¯¢ç»“æžœï¼š {'GXNHLT1100.IXRL': '374.41'}

http://www.shbaoenergy.com:8081/api/api/services/Runtime/Authentication/UserTrustLoginAsync

é«˜ç‚‰å·¥åºèƒ½è€—å®žç»©ç´¯è®¡å€¼

192.168.122.7 www.shbaoenergy.com

{
    "appId":"EC",
    "userName":"ec@share",
    "tenancyName":"zjis",
    "timestamp":1755593290049,
    "enc":"B1F6BCE403B31D8E75D834F90C9B990B"
}

